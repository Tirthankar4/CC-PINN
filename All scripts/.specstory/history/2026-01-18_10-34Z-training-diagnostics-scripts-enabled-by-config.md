<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session ec014c57-7a45-422b-8863-7561197d78e2 (2026-01-18 10:34Z) -->

# Training diagnostics scripts enabled by config (2026-01-18 10:34Z)

_**User (2026-01-18 09:51Z)**_

config.py has a option ENABLE_TRAINING_DIAGNOSTICS. which scripts does this option enabling need (i mean which are the training diagnostics scripts)

---

_**Agent (model default, mode Ask)**_



---

Checking `config.py` for `ENABLE_TRAINING_DIAGNOSTICS`, then searching the codebase for its usages.


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: config.py</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="grep">
<details>
<summary>Tool use: **grep**</summary>


Parameters:

```json
{
  "pattern": "ENABLE_TRAINING_DIAGNOSTICS",
  "outputMode": "content",
  "caseInsensitive": false
}
```
Additional data:

```json
{
  "isPruned": true,
  "pattern": "ENABLE_TRAINING_DIAGNOSTICS",
  "path": ".",
  "outputMode": "content",
  "totalFiles": 3,
  "totalMatches": 4,
  "topFiles": [
    {
      "uri": ".\\training\\trainer.py",
      "matchCount": 2
    },
    {
      "uri": ".\\config.py",
      "matchCount": 1
    },
    {
      "uri": ".\\training\\physics.py",
      "matchCount": 1
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---



---

Checking how `ENABLE_TRAINING_DIAGNOSTICS` is used in the training scripts:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: training/trainer.py</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: training/physics.py</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: utilities/training_diagnostics.py</summary>

</details>
</tool-use>

---



---

Checking if `physics.py` actually uses `ENABLE_TRAINING_DIAGNOSTICS` or just imports it:


---

<tool-use data-tool-type="unknown" data-tool-name="grep">
<details>
<summary>Tool use: **grep**</summary>


Parameters:

```json
{
  "pattern": "ENABLE_TRAINING_DIAGNOSTICS",
  "path": "training/physics.py",
  "outputMode": "content",
  "contextBefore": 5,
  "contextAfter": 5,
  "caseInsensitive": false
}
```
Additional data:

```json
{
  "isPruned": true,
  "pattern": "ENABLE_TRAINING_DIAGNOSTICS",
  "path": "training/physics.py",
  "outputMode": "content",
  "totalFiles": 1,
  "totalMatches": 1,
  "topFiles": [
    {
      "uri": "training/physics.py",
      "matchCount": 11
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---



---

## Scripts that use `ENABLE_TRAINING_DIAGNOSTICS`:

1. **`training/trainer.py`** — Main usage:
   - Line 10: Imports `ENABLE_TRAINING_DIAGNOSTICS`
   - Line 43: Conditionally creates a `TrainingDiagnostics` object if enabled
   - Lines 52-66: Logs diagnostics every 50 iterations during Adam training
   - Lines 93-106: Logs diagnostics every 50 iterations during L-BFGS training
   - Lines 115-120: Generates final diagnostic plots at the end of training

2. **`utilities/training_diagnostics.py`** — Implementation:
   - Defines the `TrainingDiagnostics` class used by `trainer.py`
   - Provides logging and plotting (loss evolution, density statistics, gradients, etc.)

3. **`training/physics.py`** — Unused import:
   - Line 14: Imports `ENABLE_TRAINING_DIAGNOSTICS` but doesn't use it

**Summary**: When `ENABLE_TRAINING_DIAGNOSTICS = True`, `trainer.py` creates a `TrainingDiagnostics` instance and logs metrics during training, generating plots saved to `./diagnostics/`. The core functionality is in `utilities/training_diagnostics.py`, but the flag is checked in `training/trainer.py`.

---

_**User (2026-01-18 09:51Z)**_

is any script of utilities folder used for training diagnostics?

---

_**Agent (model default, mode Ask)**_



---

Checking which utilities scripts are used for training diagnostics:


---

<tool-use data-tool-type="unknown" data-tool-name="list_dir">
<details>
<summary>Tool use: **list_dir**</summary>


Parameters:

```json
{
  "targetDirectory": "utilities",
  "shouldEnrichTerminalMetadata": false
}
```
Additional data:

```json
{
  "isPruned": true,
  "rootPath": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities",
  "totalDirs": 0,
  "totalFiles": 13,
  "topEntries": [
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/__init__.py",
      "isDir": false
    },
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/analyze_numerical.py",
      "isDir": false
    },
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/compare_initial_phi.py",
      "isDir": false
    },
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/compare_laplacian_operators_gpu.py",
      "isDir": false
    },
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/compare_model.py",
      "isDir": false
    },
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/compare_models_with_fd.py",
      "isDir": false
    },
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/diagnose_comparison.py",
      "isDir": false
    },
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/fd_diagnostics.py",
      "isDir": false
    },
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/find_good_seeds.py",
      "isDir": false
    },
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/test_initial_conditions_3d.py",
      "isDir": false
    },
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/test_lax_integration.py",
      "isDir": false
    },
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/test_lax_solvers.py",
      "isDir": false
    },
    {
      "path": "c:\\Users\\tirth\\Documents\\Projects\\GRINN\\Power spectrum perturbations\\utilities/training_diagnostics.py",
      "isDir": false
    }
  ],
  "extensionCounts": {
    ".py": 13
  }
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="grep">
<details>
<summary>Tool use: **grep**</summary>


Parameters:

```json
{
  "pattern": "training_diagnostics",
  "outputMode": "content",
  "caseInsensitive": false
}
```
Additional data:

```json
{
  "isPruned": true,
  "pattern": "training_diagnostics",
  "path": ".",
  "outputMode": "content",
  "totalFiles": 4,
  "totalMatches": 4,
  "topFiles": [
    {
      "uri": ".\\training\\trainer.py",
      "matchCount": 1
    },
    {
      "uri": ".\\package_for_kaggle.py",
      "matchCount": 1
    },
    {
      "uri": ".\\training\\physics.py",
      "matchCount": 1
    },
    {
      "uri": ".\\utilities\\__init__.py",
      "matchCount": 1
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="grep">
<details>
<summary>Tool use: **grep**</summary>


Parameters:

```json
{
  "pattern": "from utilities|import.*utilities",
  "outputMode": "content",
  "caseInsensitive": false
}
```
Additional data:

```json
{
  "isPruned": true,
  "pattern": "from utilities|import.*utilities",
  "path": ".",
  "outputMode": "content",
  "totalFiles": 5,
  "totalMatches": 6,
  "topFiles": [
    {
      "uri": ".\\training\\trainer.py",
      "matchCount": 1
    },
    {
      "uri": ".\\training\\physics.py",
      "matchCount": 1
    },
    {
      "uri": ".\\utilities\\diagnose_comparison.py",
      "matchCount": 2
    },
    {
      "uri": ".\\utilities\\compare_model.py",
      "matchCount": 1
    },
    {
      "uri": ".\\utilities\\analyze_numerical.py",
      "matchCount": 1
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---



---

Checking if other utilities scripts are related to training diagnostics:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: utilities/fd_diagnostics.py</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: utilities/diagnose_comparison.py</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="grep">
<details>
<summary>Tool use: **grep**</summary>


Parameters:

```json
{
  "pattern": "ENABLE_TRAINING_DIAGNOSTICS|TrainingDiagnostics|training_diagnostics",
  "path": "utilities",
  "outputMode": "content",
  "caseInsensitive": false
}
```
Additional data:

```json
{
  "isPruned": true,
  "pattern": "ENABLE_TRAINING_DIAGNOSTICS|TrainingDiagnostics|training_diagnostics",
  "path": "utilities",
  "outputMode": "content",
  "totalFiles": 2,
  "totalMatches": 2,
  "topFiles": [
    {
      "uri": "utilities\\training_diagnostics.py",
      "matchCount": 1
    },
    {
      "uri": "utilities\\__init__.py",
      "matchCount": 1
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---



---

Yes. Only one utilities script is used for training diagnostics:

## `utilities/training_diagnostics.py`

This is the only utilities script used when `ENABLE_TRAINING_DIAGNOSTICS = True`. It:

1. Defines the `TrainingDiagnostics` class
2. Is imported by `training/trainer.py` (line 9)
3. Provides real-time logging and plotting during training:
   - Loss evolution (total, PDE, IC)
   - Loss balance ratios
   - Density statistics and growth rates
   - Gradient magnitudes
   - PDE residual statistics

**Other utilities scripts** (`fd_diagnostics.py`, `diagnose_comparison.py`, etc.) are for post-training analysis (e.g., comparing PINN vs finite difference solutions) and are not related to the `ENABLE_TRAINING_DIAGNOSTICS` flag.

**Summary**: When `ENABLE_TRAINING_DIAGNOSTICS = True`, only `utilities/training_diagnostics.py` is used. It's imported and instantiated in `training/trainer.py` to log metrics and generate diagnostic plots during training.

---

